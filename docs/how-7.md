# "åä¸‡ä¸ª"æ€ä¹ˆåšï¼šå¦‚ä½•è§£å†³ Jenkins æç¤º `... "ENOSPC: no space left on device..` é—®é¢˜

## èƒŒæ™¯

æŸå¤©åŒäº‹è¯´ Jenkins æ²¡æ³•éƒ¨ç½²äº†ï¼Œåœ¨é¡¹ç›®çš„è§†å›¾ä¸­æç¤ºå¦‚ä¸‹ï¼š

![img.png](../assets/imgs/img2.png)

ï¼ˆå›¾1ï¼‰

## æŸ¥æ‰¾åŸå› 

å‘ç°ä¸€å¤´é›¾æ°´ï¼Œç„¶åé€šè¿‡æŸ¥è¯¢å¤±è´¥çš„æ„å»ºå†å²ä¸­çš„æ—¥å¿—ä¸­å‘ç°äº†å¦‚ä¸‹å…³é”®è¯ï¼š`... "ENOSPC: no space left on device..` ï¼ˆå¤§æ¦‚æ„æ€å°±æ˜¯æœåŠ¡å™¨ä¸Šçš„ç©ºé—´ä¸è¶³äº†ï¼‰ã€‚

å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬ç™»å½•åˆ°æœåŠ¡å™¨æŸ¥çœ‹ç£ç›˜ç©ºé—´ï¼ˆ`df -h`ï¼‰å‘ç°ç£ç›˜ä½¿ç”¨ç‡ 100%ï¼Œå½“æˆ‘ä»¬é‡Šæ”¾ä¸€éƒ¨åˆ†ç©ºé—´åï¼ˆå¦‚ å›¾3 æ‰€ç¤ºç‚¹å‡» `æ¸…ç©ºå·¥ä½œç©ºé—´` ï¼‰ï¼Œå†æ¬¡éƒ¨ç½²å‘ç°æˆåŠŸã€‚

![img.png](../assets/imgs/img_1.png)

ï¼ˆå›¾2ï¼‰ ï¼ˆğŸ‘†æ˜¯ä¼˜åŒ–åçš„ç©ºé—´ï¼Œä¸€å¼€å§‹çº¢è‰²åŒºåŸŸçš„å·²ç”¨æ˜¯ 100%ï¼‰

![img.png](../assets/imgs/img3.png)

ï¼ˆå›¾3ï¼‰

### åˆ†æ

é‚£ä¹ˆä¸ºå•¥ä¼šå‡ºç°ç£ç›˜ç©ºé—´ä¸è¶³çš„æƒ…å†µå‘¢ï¼šé™¤äº†å…¶ä»–ç”¨æˆ·åœ¨ç›¸åŒçš„ç£ç›˜å†…å­˜å‚¨æ–‡ä»¶å¤–ï¼ŒJenkins æ¯æ¬¡éƒ¨ç½²ä¹Ÿä¼šäº§ç”Ÿæ–‡ä»¶ã€‚

ç”±äºæˆ‘ä»¬ä¸»è¦ç”¨æ¥éƒ¨ç½²å‰ç«¯é¡¹ç›®ï¼Œåœ¨æ‰“åŒ…å‰éƒ½ä¼šå®‰è£…ä¾èµ–ï¼Œä½†æ˜¯éƒ¨ç½²æˆåŠŸååˆæ²¡æœ‰åŠæ—¶åˆ é™¤ `node_modules`ï¼Œéšç€é¡¹ç›®çš„å¢å¤šï¼Œå ç”¨çš„ç©ºé—´ä¹Ÿè¶Šæ¥è¶Šå¤§ã€‚

## æ€ä¹ˆåš

### ç¬¬ä¸€ç§ï¼šä¸´æ—¶æ–¹æ¡ˆ

- è¿›å…¥æ¯ä¸ª Jenkins çš„è§†å›¾ï¼Œç„¶åæ‰‹åŠ¨æ¸…ç©º `å·¥ä½œç©ºé—´`ï¼Œå¦‚å›¾3æ‰€ç¤ºã€‚

### ç¬¬äºŒç§ï¼šä¸€åŠ³æ°¸é€¸

> æ³¨æ„ä¸€å®šè¦åšå¥½å¤‡ä»½ï¼Œè¦ä¸å¤±è´¥äº†å¯å°±éº»çƒ¦äº†ã€‚
> 
> æ³¨æ„ä¸€å®šè¦åšå¥½å¤‡ä»½ï¼Œè¦ä¸å¤±è´¥äº†å¯å°±éº»çƒ¦äº†ã€‚
> 
> æ³¨æ„ä¸€å®šè¦åšå¥½å¤‡ä»½ï¼Œè¦ä¸å¤±è´¥äº†å¯å°±éº»çƒ¦äº†ã€‚

1ã€å°† Jenkins çš„ `jenkins_home` ç›®å½•è¿ç§»åˆ°ç©ºé—´æ›´å¤§çš„ç£ç›˜å†…ï¼ˆJenkins å­˜å‚¨çš„æ‰€æœ‰æ•°æ®éƒ½åœ¨ `jenkins_home` è¿™ä¸ªç›®å½•ä¸‹ï¼‰ã€‚

2ã€æ¯æ¬¡éƒ¨ç½²æˆåŠŸåéƒ½å°† `node_modules` åŠæ—¶åˆ é™¤ã€‚

#### å®æ“ç¯èŠ‚

- *ç¬¬ 1 æ­¥*ï¼šåšå¥½å¤‡ä»½
  - 1.1 æ‰¾åˆ° Jenkins çš„ä¸»è¦ç©ºé—´ç›®å½•ï¼šJenkins > ç³»ç»Ÿç®¡ç† > ç³»ç»Ÿä¿¡æ¯ > JENKINS_HOME
    - ![img.png](../assets/imgs/img4.png)
    - ![img_1.png](../assets/imgs/img5.png)
  - 1.2 æ‰‹åŠ¨å¤‡ä»½ JENKINS_HOME å¯¹åº”çš„ç›®å½•
    - `cp -r /var/libjenkins å¤‡ä»½çš„è·¯å¾„`
  - 1.3 é€šè¿‡æ’ä»¶ [Thin Backup Plugin](https://plugins.jenkins.io/thinBackup/#releases) ï¼Œæ¥å¤‡ä»½å…¨å±€é…ç½®å’Œå·¥ä½œç›®å½•é…ç½®ã€‚

- *ç¬¬ 2 æ­¥*ï¼šåœæ­¢ Jenkins æœåŠ¡
  - `systemctl stop jenkins`

- *ç¬¬ 3 æ­¥*ï¼šæ›´æ”¹ `JENKINS_HOME` ç¯å¢ƒå˜é‡çš„å€¼
  - 3.1 `vim /etc/sysconfig/jenkins`
  - 3.2 æ‰¾åˆ° `JENKINS_HOME` å¹¶ä¿®æ”¹å€¼ä¸ºä½ è¦è¿ç§»çš„ç›®å½•
  - 3.3 ä¿å­˜å¹¶é€€å‡º

- *ç¬¬ 4 æ­¥*ï¼šé‡å¯ Jenkins æœåŠ¡
  - `systemctl start jenkins`

## æ€»ç»“

1ã€ä»¥ä¸Šæ“ä½œç¯å¢ƒæ˜¯åœ¨ `centos 7.9` ä¸­è¿›è¡Œçš„ã€‚

2ã€Jenkins çš„å®‰è£…æ–¹å¼æ˜¯é€šè¿‡ `yum` å®‰è£…çš„ã€‚

3ã€Jenkins æœåŠ¡æ˜¯é€šè¿‡ `systemctl` å¯åŠ¨çš„ã€‚å¹¶æ²¡æœ‰ç”¨ `docker` ã€ `Tomcat`ï¼Œå¦‚æœæ˜¯ä»¥ä¸Šä¸¤ç§æ–¹å¼é‚£ä¹ˆæ“ä½œæ–¹å¼æ˜¯ä¸é€šçš„å“¦ã€‚

4ã€å¦‚æœåœ¨é‡å¯ Jenkins æ—¶æç¤º `Starting Jenkins bash: /usr/bin/java: No such file or directory`ï¼Œå¯ä»¥æ‰‹åŠ¨æ·»åŠ  `jdk` (é€šè¿‡å‘½ä»¤ `which java` å¯è·å–) çš„è·¯å¾„åˆ°æ–‡ä»¶ `/etc/init.d/jenkins` ä¸­ã€‚

å‚è€ƒé“¾æ¥ï¼š

* [Jenkins é…ç½® jdk](https://blog.csdn.net/a772304419/article/details/100916667)
